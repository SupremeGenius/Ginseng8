@page
@model Ginseng.Mvc.Pages.Work.AllItemsModel
@{
    ViewData["Title"] = "All Items";
}

@if (Model.Query != null)
{
    <p class="text-center">Searched for: <strong>@Model.Query</strong></p>
}

<div id="accordion">
@foreach (var appGrp in Model.WorkItems.GroupBy(row => row.ApplicationId))
{
    <h4>@appGrp.First().ApplicationName</h4>
    @await Html.PartialAsync("Items/_InsertItem", new InsertItemView(new Dictionary<string, int>()
    {
        { "applicationId", appGrp.Key }                        
    }))
    foreach (var item in appGrp)
    {
        <partial name="Items/_Card" model="new WorkItemCardView() { WorkItem = item, Dropdowns = Model.Dropdowns, SelectedLabels = Model.SelectedLabels[item.Id], UserId = Model.UserId, Comments = Model.Comments[item.Id] }" />
    }
}
</div>